# Банковский онлайн-калькулятор

Веб-приложение для банка, предоставляющее пользователям функцию онлайн-калькулятора для расчета ипотеки, автокредита, потребительского кредита и пенсионных накоплений.

## Технологии

- **Frontend**: React
- **Backend**: Node.js, Express
- **База данных**: MongoDB
- **Пакетный менеджер**: Yarn

## Функциональность

- Расчет ипотеки
- Расчет автокредита
- Расчет потребительского кредита
- Расчет пенсионных накоплений
- Отправка результатов расчетов на почту
- Административная панель для управления калькуляторами

## Установка и запуск

### Предварительные требования

- Node.js (версия 14.x или выше)
- Yarn
- MongoDB (локально или удаленно)

### Шаги по установке

1. Установить зависимости:

   ```bash
   yarn install-all
   ```

2. Создать файл .env

   ```bash
   cp .env.example .env
   ```

3. Отредактировать файл .env, указав свои параметры подключения к MongoDB и другие настройки.

   ### Пример запуска контейнера mongodb с данными как в .env

   ```bash
   docker run --name mongoBanking -d -p 27017:27017 -e MONGO_INITDB_ROOT_USERNAME=mongo -e MONGO_INITDB_ROOT_PASSWORD=secret -e MONGO_INITDB_DATABASE=banking-calculator mongo:latest
   ```

   ### Для работы отправки писем на почту

      - Если почта которая должно отправлять письма будет mail.ru, то в нужно написать в `EMAIL_SERVICE`(`.env`) значение ``EMAIL_SERVICE=mail.ru``. Если почта для отправки будет gmail, то нужно оставить как в примере `.env.example`
      - Указание пароля должно быть не от самой почты (который используется для входа), а специально сгенерированным паролем для приложений:
         - [Гайд для получения пароля для mail.ru](https://help.mail.ru/mail/mailer/password/)
         - [Гайд для получения пароля для gmail.com](https://support.google.com/mail/answer/185833?hl=ru)

4. Запустить приложение в режиме разработки:

   ```bash
   yarn dev
   ```

5. Приложение будет доступно по адресу:
   - Frontend: <http://localhost:3000>
   - Backend API: <http://localhost:5000>

## Структура проекта

```tree
banking/
├── client/            # Frontend (React)
│   ├── public/        # Статические файлы
│   └── src/           # Исходный код React
│       ├── components/  # Компоненты React
│       ├── context/     # Context API
│       ├── pages/       # Страницы приложения
│       ├── styles/      # CSS стили
│       └── utils/       # Вспомогательные функции
│
├── server/            # Backend (Node.js + Express)
│   ├── config/        # Конфигурационные файлы
│   ├── controllers/   # Контроллеры
│   ├── middleware/    # Middleware
│   ├── models/        # MongoDB модели
│   ├── routes/        # API маршруты
│   ├── services/      # Бизнес-логика
│   └── utils/         # Вспомогательные функции
│
└── README.md          # Документация проекта
```

## Инициализация базы данных

Для инициализации базы данных с начальными данными выполните следующую команду:

```bash
node server/config/seedDatabase.js
```

Это создаст администратора с учетными данными:

- Email: <admin@example.com>
- Пароль: admin123

И добавит базовые калькуляторы с предустановленными параметрами.

## Формулы для расчета

### Ипотека

- **Годовая процентная ставка:** Берется из настроек калькулятора в базе данных.
- **Сумма кредита:** `Стоимость недвижимости - Первоначальный взнос`
- **Ежемесячная ставка:** `Годовая ставка / 12 / 100`
- **Общая ставка (для формулы):** `(1 + Ежемесячная ставка) ^ (Срок ипотеки в годах * 12)`
- **Ежемесячный платеж:** `Сумма кредита * Ежемесячная ставка * Общая ставка / (Общая ставка - 1)`
- **Необходимый доход:** `Ежемесячный платеж * 2.5`

### Автокредит

- **Годовая процентная ставка:** Берется из настроек калькулятора в базе данных.
- **Сумма кредита:** `Стоимость автомобиля - Первоначальный взнос`
- **Ежемесячная ставка:** `Годовая ставка / 12 / 100`
- **Общая ставка (для формулы):** `(1 + Ежемесячная ставка) ^ (Срок кредита в годах * 12)`
- **Ежемесячный платеж:** `Сумма кредита * Ежемесячная ставка * Общая ставка / (Общая ставка - 1)`
- **Необходимый доход:** `Ежемесячный платеж * 2.5`

### Потребительский кредит

- **Годовая процентная ставка:** Берется из настроек калькулятора в базе данных.
- **Сумма кредита:** Предоставляется пользователем.
- **Ежемесячная ставка:** `Годовая ставка / 12 / 100`
- **Общая ставка (для формулы):** `(1 + Ежемесячная ставка) ^ (Срок кредита в годах * 12)`
- **Ежемесячный платеж:** `Сумма кредита * Ежемесячная ставка * Общая ставка / (Общая ставка - 1)`
- **Необходимый доход:** `Ежемесячный платеж * 2.5`

### Пенсионные накопления

- **Годовая процентная ставка:** Берется из настроек калькулятора в базе данных.
- **Ежемесячная ставка:** Годовая ставка / 12 / 100
- **Общий срок в месяцах:** Срок накопления (в годах) \* 12
- **Будущая стоимость первоначального взноса:** `Первоначальный взнос * (1 + Ежемесячная ставка) ^ Общий срок в месяцах`
- **Будущая стоимость ежемесячных пополнений:** `Ежемесячное пополнение * (((1 + Ежемесячная ставка) ^ Общий срок в месяцах) - 1) / Ежемесячная ставка`
- **Итоговые накопления:** `Будущая стоимость первоначального взноса + Будущая стоимость ежемесячных пополнений`
- **Ежемесячная пенсия:** `Итоговые накопления / (20 * 12)` (исходя из предполагаемого срока выплат в 20 лет)
